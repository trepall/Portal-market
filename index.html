<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portals Market</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            color: #fff;
            padding-bottom: 80px;
            transition: background 0.3s;
            min-height: 100vh;
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .close-btn {
            font-size: 18px;
            color: #666;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .settings-btn {
            background: none;
            border: none;
            color: #666;
            font-size: 20px;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .settings-btn:hover {
            background: rgba(255,255,255,0.1);
        }

        .search-container {
            position: relative;
            width: 100%;
            margin-bottom: 20px;
        }

        .search-input {
            width: 100%;
            padding: 12px 40px 12px 15px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            color: white;
            font-size: 14px;
        }

        .search-input:focus {
            border-color: #4facfe;
            outline: none;
        }

        .search-icon {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: #666;
            cursor: pointer;
        }

        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
            position: relative;
            z-index: 10;
        }

        .filter {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            position: relative;
            user-select: none;
            transition: all 0.2s;
        }

        .filter:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateY(-2px);
        }

        .filter-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            background: rgba(42, 42, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 10px;
            margin-top: 5px;
            min-width: 150px;
            max-width: 200px;
            z-index: 1000;
            max-height: 300px;
            overflow-y: auto;
            display: none;
            box-shadow: 0 10px 20px rgba(0,0,0,0.3);
        }

        .filter-option {
            padding: 8px 12px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s;
        }

        .filter-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .filter-option.active {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
        }

        .price-range {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 16px;
            border-radius: 16px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .price-inputs {
            display: flex;
            gap: 10px;
            margin-bottom: 10px;
        }

        .price-input {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 10px 12px;
            border-radius: 12px;
            width: 100%;
            font-size: 14px;
        }

        .price-input:focus {
            border-color: #4facfe;
            outline: none;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            border: none;
            color: #fff;
            padding: 12px 15px;
            border-radius: 16px;
            cursor: pointer;
            margin-bottom: 15px;
            transition: all 0.3s;
            width: 100%;
            font-size: 16px;
            font-weight: 600;
            box-shadow: 0 4px 10px rgba(79, 172, 254, 0.3);
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(79, 172, 254, 0.4);
        }

        .products-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .product-card {
            border-radius: 16px;
            padding: 16px;
            position: relative;
            transition: transform 0.2s;
            background: linear-gradient(135deg, var(--card-color), rgba(42, 42, 42, 0.8));
            border: 1px solid var(--card-border);
            display: flex;
            justify-content: space-between;
            align-items: center;
            animation: fadeIn 0.5s ease-in;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            overflow: hidden;
            backdrop-filter: blur(5px);
            cursor: pointer;
        }

        .product-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--card-border);
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }

        .product-info {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .product-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            font-weight: bold;
            flex-shrink: 0;
        }

        .product-details {
            flex: 1;
        }

        .product-name {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .product-id {
            font-size: 12px;
            color: rgba(255,255,255,0.7);
            cursor: pointer;
            padding: 4px 8px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
            display: inline-block;
            transition: background 0.2s;
        }

        .product-id:hover {
            background: rgba(0,0,0,0.5);
        }

        .product-price-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .product-price {
            font-size: 14px;
            font-weight: 600;
            color: #fff;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            padding: 6px 10px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            white-space: nowrap;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .cart-btn {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border: none;
            color: #fff;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            transition: all 0.2s;
        }

        .cart-btn:hover {
            transform: scale(1.1);
        }

        .cart-icon {
            width: 20px;
            height: 20px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #ddd;
        }

        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(42, 42, 42, 0.9);
            backdrop-filter: blur(10px);
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            padding: 12px 20px;
            display: flex;
            justify-content: space-around;
            z-index: 1000;
        }

        .nav-item {
            text-align: center;
            font-size: 10px;
            color: #ddd;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            flex: 1;
            transition: all 0.2s;
            padding: 5px;
            border-radius: 10px;
        }

        .nav-item.active {
            color: #fff;
            background: rgba(255, 255, 255, 0.1);
        }

        .nav-icon {
            width: 24px;
            height: 24px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .nav-market { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M7 18c-1.1 0-1.99.9-1.99 2S5.9 22 7 22s2-.9 2-2-.9-2-2-2zM1 2v2h2l3.6 7.59-1.35 2.45c-.16.28-.25.61-.25.96 0 1.1.9 2 2 2h12v-2H7.42c-.14 0-.25-.11-.25-.25l.03-.12.9-1.63h7.45c.75 0 1.41-.41 1.75-1.03l3.58-6.49c.08-.14.12-.31.12-.48 0-.55-.45-1-1-1H5.21l-.94-2H1zm16 16c-1.1 0-1.99.9-1.99 2s.89 2 1.99 2 2-.9 2-2-.9-2-2-2z"/></svg>'); }
        .nav-gifts { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M20 6h-2.18c.11-.31.18-.65.18-1 0-1.66-1.34-3-3-3-1.05 0-1.96.54-2.5 1.35l-.5.67-.5-.68C10.96 2.54 10.05 2 9 2 7.34 2 6 3.34 6 5c0 .35.07.69.18 1H4c-1.11 0-1.99.89-1.99 2L2 19c0 1.11.89 2 2 2h16c1.11 0 2-.89 2-2V8c0-1.11-.89-2-2-2zm-5-2c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zM9 4c.55 0 1 .45 1 1s-.45 1-1 1-1-.45-1-1 .45-1 1-1zm11 15H4v-2h16v2zm0-5H4V8h5.08L7 10.83 8.62 12 11 8.76l1-1.36 1 1.36L15.38 12 17 10.83 14.92 8H20v6z"/></svg>'); }
        .nav-wallet { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M21 18v1c0 1.1-.9 2-2 2H5c-1.11 0-2-.9-2-2V5c0-1.1.89-2 2-2h14c1.1 0 2 .9 2 2v1h-9c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h9zm-9-2h10V8H12v8zm4-2.5c-.83 0-1.5-.67-1.5-1.5s.67-1.5 1.5-1.5 1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>'); }
        .nav-profile { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>'); }
        .nav-support { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>'); }

        .nav-item.active .nav-icon {
            filter: brightness(0) invert(1);
        }

        .nav-item:not(.active) .nav-icon {
            filter: brightness(0) invert(0.7);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .profile-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        .profile-avatar {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: pointer;
            overflow: hidden;
            border: 3px solid rgba(255, 255, 255, 0.3);
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
            flex-shrink: 0;
        }

        .profile-avatar:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.6);
        }

        .avatar-placeholder {
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }

        .avatar-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .avatar-icon {
            width: 50px;
            height: 50px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .edit-pencil {
            position: absolute;
            bottom: 5px;
            right: 5px;
            background: rgba(79, 172, 254, 0.9);
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s;
            border: 2px solid white;
        }

        .profile-avatar:hover .edit-pencil {
            opacity: 1;
        }

        .profile-info {
            flex: 1;
            min-width: 0;
        }

        .profile-name-container {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 5px;
            cursor: pointer;
            padding: 5px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .profile-name-container:hover {
            background: rgba(255,255,255,0.1);
        }

        .profile-name {
            font-size: 20px;
            font-weight: 600;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .edit-icon {
            width: 16px;
            height: 16px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>');
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
            opacity: 0.7;
        }

        .name-input {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            font-size: 20px;
            font-weight: 600;
            width: 100%;
            padding: 5px 10px;
            border-radius: 8px;
            outline: none;
        }

        .name-input:focus {
            border-color: #4facfe;
        }

        .balance-section {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.2));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 25px rgba(79, 172, 254, 0.3);
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .balance-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(79, 172, 254, 0.4);
        }

        .balance-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .balance-title {
            font-size: 18px;
            color: #ddd;
        }

        .balance-amount {
            font-size: 32px;
            font-weight: 700;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .balance-currency {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: #fff;
            padding: 6px 12px;
            border-radius: 10px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
        }

        .balance-currency:hover {
            transform: scale(1.05);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.2));
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .stat-label {
            color: #ddd;
            font-size: 16px;
        }

        .settings-section {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.2));
            border-radius: 20px;
            padding: 0;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .settings-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background 0.2s;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-item:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .settings-item-content {
            display: flex;
            align-items: center;
            gap: 12px;
            flex: 1;
        }

        .settings-icon {
            width: 20px;
            height: 20px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .icon-settings { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M19.14 12.94c.04-.3.06-.61.06-.94 0-.32-.02-.64-.07-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.05.3-.09.63-.09.94s.02.64.07.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>'); }
        .icon-language { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"/></svg>'); }
        .icon-currency { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91 1.91.46 3.39 1.24 3.39 3.19 0 1.8-1.39 2.83-3.13 3.16z"/></svg>'); }
        .icon-support { background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 17h-2v-2h2v2zm2.07-7.75l-.9.92C13.45 12.9 13 13.5 13 15h-2v-.5c0-1.1.45-2.1 1.17-2.83l1.24-1.26c.37-.36.59-.86.59-1.41 0-1.1-.9-2-2-2s-2 .9-2 2H8c0-2.21 1.79-4 4-4s4 1.79 4 4c0 .88-.36 1.68-.93 2.25z"/></svg>'); }

        .settings-arrow {
            color: #ddd;
            font-size: 14px;
        }

        .total-volume {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.2));
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s;
            backdrop-filter: blur(10px);
        }

        .total-volume:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .total-volume-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .total-volume-label {
            color: #ddd;
            font-size: 16px;
        }

        .requisites-card {
            background: linear-gradient(135deg, rgba(79, 172, 254, 0.2), rgba(0, 242, 254, 0.2));
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .requisites-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .requisites-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.2s;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: white;
            font-weight: 600;
        }

        .requisites-btn:hover {
            transform: translateY(-2px);
        }

        .deposit-screen, .withdraw-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a2e, #16213e, #0f3460);
            z-index: 2000;
            overflow-y: auto;
            padding-bottom: 80px;
        }

        .deposit-screen.active, .withdraw-screen.active {
            display: block;
        }

        .deposit-content, .withdraw-content {
            max-width: 400px;
            margin: 0 auto;
            padding: 20px;
        }

        .deposit-header, .withdraw-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .deposit-back, .withdraw-back {
            font-size: 18px;
            color: #666;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .deposit-back:hover, .withdraw-back:hover {
            background: rgba(255,255,255,0.1);
        }

        .deposit-title, .withdraw-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .deposit-info {
            margin-top: 15px;
        }

        .requisites-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .requisites-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #4facfe;
        }

        .requisites-value {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 12px;
            border-radius: 8px;
            word-break: break-all;
            cursor: pointer;
            transition: background 0.2s;
        }

        .requisites-value:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        .withdraw-form {
            margin-top: 15px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .form-input {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px 15px;
            border-radius: 12px;
            font-size: 16px;
        }

        .form-input:focus {
            border-color: #4facfe;
            outline: none;
        }

        .form-select {
            width: 100%;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #fff;
            padding: 12px 15px;
            border-radius: 12px;
            font-size: 16px;
            cursor: pointer;
        }

        .submit-btn {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border: none;
            color: #fff;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.2s;
            margin-top: 10px;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(79, 172, 254, 0.4);
        }

        .balance-currencies {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 20px;
        }

        .balance-currency-item {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .balance-currency-amount {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .balance-currency-name {
            font-size: 14px;
            color: #ddd;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(42, 42, 42, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 15px 20px;
            max-width: 300px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
            z-index: 2000;
            transform: translateX(400px);
            transition: transform 0.3s ease-out;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            border-left: 4px solid #4CAF50;
        }

        .notification.error {
            border-left: 4px solid #f44336;
        }

        .notification.info {
            border-left: 4px solid #4facfe;
        }

        .notification-content {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .notification-close {
            background: none;
            border: none;
            color: #ddd;
            font-size: 18px;
            cursor: pointer;
            margin-left: auto;
        }

        #settings-tab {
            display: none;
        }

        #settings-tab.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 3000;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: rgba(42, 42, 42, 0.95);
            border-radius: 20px;
            padding: 25px;
            width: 320px;
            max-width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .modal-option {
            padding: 12px 15px;
            border-radius: 10px;
            cursor: pointer;
            margin-bottom: 8px;
            transition: background 0.2s;
        }

        .modal-option:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .modal-option.active {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .modal-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 600;
        }

        .modal-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .modal-save {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: white;
        }

        .letter-icon {
            font-size: 36px;
            font-weight: 700;
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .gifts-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .gift-tab {
            flex: 1;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 12px 16px;
            border-radius: 16px;
            font-size: 14px;
            text-align: center;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.2s;
        }

        .gift-tab.active {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
        }

        .gift-tab:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .sub-tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
        }

        .sub-tab {
            flex: 1;
            background: rgba(255, 255, 255, 0.05);
            padding: 10px 12px;
            border-radius: 12px;
            font-size: 13px;
            text-align: center;
            cursor: pointer;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s;
        }

        .sub-tab.active {
            background: rgba(79, 172, 254, 0.3);
            border-color: rgba(79, 172, 254, 0.7);
        }

        .add-product-btn {
            background: linear-gradient(135deg, #4facfe, #00f2fe);
            border: none;
            color: #fff;
            padding: 15px;
            border-radius: 16px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.3s;
            margin-top: 20px;
            box-shadow: 0 4px 10px rgba(79, 172, 254, 0.3);
        }

        .add-product-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(79, 172, 254, 0.4);
        }

        .instruction-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .instruction-step {
            margin-bottom: 15px;
            padding-left: 20px;
            position: relative;
        }

        .instruction-step:before {
            content: '•';
            position: absolute;
            left: 0;
            color: #4facfe;
            font-size: 18px;
        }

        .product-form {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .action-btn {
            flex: 1;
            padding: 12px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .action-btn.primary {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: white;
        }

        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .action-btn:hover {
            transform: translateY(-2px);
        }

        .product-image-preview {
            width: 100%;
            height: 200px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 15px;
            overflow: hidden;
            border: 2px dashed rgba(255, 255, 255, 0.2);
        }

        .product-image-preview img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .upload-placeholder {
            text-align: center;
            color: rgba(255, 255, 255, 0.5);
        }

        .upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .product-form-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 3000;
            overflow-y: auto;
            padding: 20px 0;
        }

        .product-form-modal.active {
            display: block;
        }

        .product-form-content {
            max-width: 400px;
            margin: 0 auto;
            background: rgba(42, 42, 42, 0.95);
            border-radius: 20px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .product-form-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .product-form-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .product-form-back {
            font-size: 18px;
            color: #666;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .product-form-back:hover {
            background: rgba(255,255,255,0.1);
        }

        .action-icon {
            width: 20px;
            height: 20px;
            background-size: contain;
            background-repeat: no-repeat;
            background-position: center;
        }

        .icon-remove {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>');
        }

        .icon-add-market {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M13 7h-2v4H7v2h4v4h2v-4h4v-2h-4V7zm-1-5C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"/></svg>');
        }

        .icon-share {
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="white"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/></svg>');
        }

        .cart-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            margin-bottom: 10px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .cart-item-info {
            flex: 1;
        }

        .cart-item-name {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .cart-item-price {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.7);
        }

        .cart-remove-btn {
            background: rgba(244, 67, 54, 0.8);
            border: none;
            color: #fff;
            padding: 8px;
            border-radius: 8px;
            cursor: pointer;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .cart-total {
            text-align: center;
            margin: 20px 0;
            font-size: 18px;
            font-weight: 600;
        }

        .buy-cart-btn {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            border: none;
            color: #fff;
            padding: 15px;
            border-radius: 12px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: all 0.2s;
        }

        .buy-cart-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(79, 172, 254, 0.4);
        }

        .share-link-container {
            margin-top: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .share-link-title {
            font-weight: 600;
            margin-bottom: 8px;
            color: #4facfe;
        }

        .share-link-value {
            font-family: monospace;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 12px;
            border-radius: 8px;
            word-break: break-all;
            cursor: pointer;
            transition: background 0.2s;
            font-size: 14px;
        }

        .share-link-value:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        .support-categories {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .support-category {
            display: flex;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 18px 20px;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            cursor: pointer;
            transition: all 0.3s;
        }

        .support-category:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        .category-icon {
            font-size: 24px;
            margin-right: 15px;
            width: 40px;
            text-align: center;
        }

        .category-info {
            flex: 1;
        }

        .category-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 4px;
        }

        .category-desc {
            font-size: 13px;
            color: rgba(255, 255, 255, 0.7);
        }

        .category-arrow {
            font-size: 18px;
            color: rgba(255, 255, 255, 0.7);
        }

        .support-section {
            animation: fadeIn 0.3s ease-in;
        }

        .support-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
        }

        .support-back {
            font-size: 18px;
            color: #4facfe;
            cursor: pointer;
            margin-right: 15px;
            padding: 8px;
            border-radius: 8px;
            transition: background 0.2s;
        }

        .support-back:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .support-content {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .support-item {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            overflow: hidden;
            cursor: pointer;
        }

        .support-question {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 16px 20px;
            font-weight: 600;
        }

        .support-arrow {
            transition: transform 0.3s;
        }

        .support-item.active .support-arrow {
            transform: rotate(180deg);
        }

        .support-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s;
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
        }

        .support-item.active .support-answer {
            padding: 0 20px 20px 20px;
            max-height: 500px;
        }

        .sync-status {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(42, 42, 42, 0.9);
            border-radius: 20px;
            padding: 10px 15px;
            font-size: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            z-index: 1000;
            backdrop-filter: blur(10px);
            display: none;
        }

        .sync-status.syncing {
            border-color: #4facfe;
            display: block;
        }

        .sync-status.success {
            border-color: #4CAF50;
            display: block;
        }

        .sync-status.error {
            border-color: #f44336;
            display: block;
        }

        .sync-btn {
            background: rgba(79, 172, 254, 0.2);
            border: 1px solid rgba(79, 172, 254, 0.5);
            color: #4facfe;
            padding: 8px 12px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
            margin-left: 10px;
        }

        .sync-btn:hover {
            background: rgba(79, 172, 254, 0.3);
        }

        .sync-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .admin-panel {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
        }

        .admin-section {
            margin-bottom: 25px;
        }

        .admin-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: 15px;
            color: #4facfe;
        }

        /* Стили для модального окна товара */
        .product-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            z-index: 2000;
            overflow-y: auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .product-modal-content {
            background: rgba(42, 42, 42, 0.95);
            border-radius: 20px;
            padding: 25px;
            max-width: 500px;
            width: 100%;
            margin: auto;
            border: 1px solid rgba(255, 255, 255, 0.2);
            max-height: 90vh;
            overflow-y: auto;
        }

        .product-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .product-modal-title {
            font-size: 24px;
            font-weight: 600;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .product-modal-close {
            font-size: 18px;
            color: #666;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            transition: background 0.2s;
        }

        .product-modal-close:hover {
            background: rgba(255,255,255,0.1);
        }

        .product-modal-image {
            width: 100%;
            height: 250px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 20px;
            overflow: hidden;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .product-modal-image img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }

        .product-modal-details {
            margin-bottom: 20px;
        }

        .product-modal-price {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-align: center;
        }

        .product-modal-description {
            color: rgba(255, 255, 255, 0.8);
            line-height: 1.5;
            margin-bottom: 15px;
        }

        .product-modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .product-modal-btn {
            flex: 1;
            padding: 14px;
            border-radius: 12px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.2s;
        }

        .product-modal-buy {
            background: linear-gradient(90deg, #4facfe, #00f2fe);
            color: white;
        }

        .product-modal-cancel {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        .product-modal-btn:hover {
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div id="sync-status" class="sync-status"></div>

    <div id="market-tab" class="tab-content active">
        <div class="container">
            <div class="header">
                <h1 id="market-title">Фильтры</h1>
                <div class="close-btn">×</div>
            </div>

            <div class="search-container">
                <input type="text" id="product-search" class="search-input" placeholder="Поиск по ID товара...">
                <div class="search-icon" onclick="performSearch()">🔍</div>
            </div>

            <div class="filters">
                <div class="filter" id="model-filter" onclick="toggleFilterDropdown('model')">
                    <span class="filter-text" id="model-filter-text">Модель</span> <span>▼</span>
                    <div class="filter-dropdown" id="model-dropdown">
                        <div class="filter-option active" data-value="all" onclick="selectFilterOption('model', 'all', 'Все модели')">Все модели</div>
                    </div>
                </div>
                <div class="filter" id="currency-filter" onclick="toggleFilterDropdown('currency')">
                    <span class="filter-text" id="currency-filter-text">Валюта</span> <span>▼</span>
                    <div class="filter-dropdown" id="currency-dropdown">
                        <div class="filter-option active" data-value="all" onclick="selectFilterOption('currency', 'all', 'Все валюты')">Все валюты</div>
                        <div class="filter-option" data-value="TON" onclick="selectFilterOption('currency', 'TON', 'TON')">TON</div>
                        <div class="filter-option" data-value="RUB" onclick="selectFilterOption('currency', 'RUB', 'RUB')">RUB</div>
                        <div class="filter-option" data-value="USD" onclick="selectFilterOption('currency', 'USD', 'USD')">USD</div>
                        <div class="filter-option" data-value="EUR" onclick="selectFilterOption('currency', 'EUR', 'EUR')">EUR</div>
                        <div class="filter-option" data-value="STARS" onclick="selectFilterOption('currency', 'STARS', 'STARS')">STARS</div>
                    </div>
                </div>
            </div>

            <div class="price-range">
                <div class="price-inputs">
                    <input type="text" class="price-input" id="price-min" placeholder="От 100" value="100">
                    <input type="text" class="price-input" id="price-max" placeholder="До 10000" value="10000">
                </div>
            </div>

            <button class="refresh-btn" onclick="refreshCatalog()">🔄 <span id="refresh-text">Обновить</span></button>

            <div class="products-list" id="products-list">
                <!-- Товары загружаются здесь -->
            </div>

            <div class="loading" id="loading" style="display: none;">⏳ <span id="loading-text">Загрузка...</span></div>
        </div>
    </div>

    <div id="gifts-tab" class="tab-content">
        <div class="container">
            <div class="header">
                <h1 id="gifts-title">Подарки</h1>
                <div class="close-btn">×</div>
            </div>

            <div class="gifts-tabs">
                <div class="gift-tab active" onclick="showGiftTab('my-gifts')" id="my-gifts-tab">Мои подарки</div>
                <div class="gift-tab" onclick="showGiftTab('cart')" id="cart-tab">Корзина</div>
            </div>

            <div id="my-gifts-content" class="gift-tab-content">
                <div class="sub-tabs">
                    <div class="sub-tab active" onclick="showSubTab('listed')" id="listed-tab">Выставленные</div>
                    <div class="sub-tab" onclick="showSubTab('unlisted')" id="unlisted-tab">Не выставленные</div>
                </div>

                <div id="listed-gifts" class="sub-tab-content">
                    <div class="products-list" id="listed-products-list">
                        <!-- Выставленные подарки -->
                    </div>
                    <div style="text-align: center; padding: 40px; color: #ddd; background: rgba(255, 255, 255, 0.1); border-radius: 20px; backdrop-filter: blur(10px); display: none;" id="no-listed-gifts">
                        <h3>Нет выставленных подарков</h3>
                    </div>
                </div>

                <div id="unlisted-gifts" class="sub-tab-content" style="display: none;">
                    <div class="products-list" id="unlisted-products-list">
                        <!-- Не выставленные подарки -->
                    </div>
                    <div style="text-align: center; padding: 40px; color: #ddd; background: rgba(255, 255, 255, 0.1); border-radius: 20px; backdrop-filter: blur(10px); display: none;" id="no-unlisted-gifts">
                        <h3>Нет не выставленных подарков</h3>
                    </div>
                </div>

                <button class="add-product-btn" onclick="openProductFormModal()">+ Добавить товар</button>
            </div>

            <div id="cart-content" class="gift-tab-content" style="display: none;">
                <div id="cart-items-container">
                    <!-- Товары в корзине -->
                </div>
                <div id="empty-cart" style="text-align: center; padding: 40px; color: #ddd; background: rgba(255, 255, 255, 0.1); border-radius: 20px; backdrop-filter: blur(10px);">
                    <h3>Корзина пуста</h3>
                </div>
                <div id="cart-total-container" style="display: none;">
                    <div class="cart-total">
                        Общая сумма: <span id="cart-total-amount">0</span> TON
                    </div>
                    <button class="buy-cart-btn" onclick="buyCartItems()">Купить все</button>
                </div>
            </div>
        </div>
    </div>

    <div id="requisites-tab" class="tab-content">
        <div class="container">
            <div class="header">
                <h1 id="requisites-title">Реквизиты</h1>
                <div class="close-btn">×</div>
            </div>
            
            <div class="requisites-card">
                <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                    <span id="balance-label">Баланс:</span>
                    <span><strong id="balance-ton">0 TON</strong></span>
                </div>
                
                <div class="balance-currencies">
                    <div class="balance-currency-item">
                        <div class="balance-currency-amount" id="balance-rub">0 ₽</div>
                        <div class="balance-currency-name">RUB</div>
                    </div>
                    <div class="balance-currency-item">
                        <div class="balance-currency-amount" id="balance-usd">0 $</div>
                        <div class="balance-currency-name">USD</div>
                    </div>
                    <div class="balance-currency-item">
                        <div class="balance-currency-amount" id="balance-eur">0 €</div>
                        <div class="balance-currency-name">EUR</div>
                    </div>
                    <div class="balance-currency-item">
                        <div class="balance-currency-amount" id="balance-stars">0 ⭐</div>
                        <div class="balance-currency-name">STARS</div>
                    </div>
                </div>
                
                <div class="requisites-actions">
                    <button class="requisites-btn" onclick="openDepositScreen()"><span id="deposit-text">Пополнить</span></button>
                    <button class="requisites-btn" onclick="openWithdrawScreen()"><span id="withdraw-text">Вывести</span></button>
                </div>
            </div>
            
            <div class="requisites-card">
                <h3 style="margin-bottom: 15px;" id="history-title">История операций</h3>
                <div style="text-align: center; color: #ddd; padding: 20px;">
                    <span id="no-operations-text">Пока нет операций</span>
                </div>
            </div>
        </div>
    </div>

    <div id="profile-tab" class="tab-content">
        <div class="container">
            <div class="header">
                <button class="settings-btn" onclick="showTab('settings-tab')">
                    <div class="settings-icon icon-settings"></div>
                </button>
                <h1 id="profile-title">Профиль</h1>
                <div class="close-btn">×</div>
            </div>

            <div class="profile-header">
                <div class="profile-avatar" onclick="document.getElementById('avatar-upload').click()">
                    <div class="avatar-placeholder">
                        <div class="avatar-icon" id="avatar-icon"></div>
                        <img id="avatar-image" class="avatar-image" style="display: none;">
                    </div>
                    <div class="edit-pencil">
                        <div class="edit-pencil-icon"></div>
                    </div>
                </div>
                <input type="file" id="avatar-upload" accept="image/*" style="display: none;">
                <div class="profile-info">
                    <div class="profile-name-container" onclick="editName()">
                        <div class="profile-name" id="profile-name-text">Пользователь</div>
                        <div class="edit-icon"></div>
                        <input type="text" class="name-input" id="profile-name-input" style="display: none;" maxlength="20">
                    </div>
                </div>
            </div>

            <div class="balance-section">
                <div class="balance-header">
                    <div class="balance-title" id="balance-title-text">Баланс</div>
                    <div class="balance-currency" onclick="toggleCurrency()">₽</div>
                </div>
                <div class="balance-amount" id="balance-amount">0.00</div>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="gifts-count">0</div>
                    <div class="stat-label" id="gifts-count-text">Подарков</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="sold-count">0</div>
                    <div class="stat-label" id="sold-text">Продано</div>
                </div>
            </div>

            <div class="total-volume">
                <div class="total-volume-value" id="total-volume">0 ₽</div>
                <div class="total-volume-label" id="total-volume-text">Общий объем торгов</div>
            </div>
        </div>
    </div>

    <div id="settings-tab" class="tab-content">
        <div class="container">
            <div class="header">
                <h1 id="settings-title">Настройки</h1>
                <div class="close-btn" onclick="showTab('profile-tab')">×</div>
            </div>

            <div class="settings-section">
                <div class="settings-item" onclick="openLanguageModal()">
                    <div class="settings-item-content">
                        <div class="settings-icon icon-language"></div>
                        <div id="language-text">Язык</div>
                    </div>
                    <div class="settings-arrow" id="current-language">Русский ›</div>
                </div>
                <div class="settings-item" onclick="openCurrencyModal()">
                    <div class="settings-item-content">
                        <div class="settings-icon icon-currency"></div>
                        <div id="currency-text">Валюта</div>
                    </div>
                    <div class="settings-arrow" id="current-currency">RUB ›</div>
                </div>
                <div class="settings-item" onclick="window.open('https://t.me/MarketSuportGift', '_blank')">
                    <div class="settings-item-content">
                        <div class="settings-icon icon-support"></div>
                        <div id="support-text">Поддержка</div>
                    </div>
                    <div class="settings-arrow">›</div>
                </div>
            </div>

            <div class="admin-panel" id="admin-panel" style="display: none;">
                <div class="admin-title">Администрирование базы знаний</div>
                
                <div class="admin-section">
                    <div style="margin-bottom: 15px;">
                        <strong>Статус базы знаний:</strong>
                        <span id="db-status">Не подключено</span>
                        <button class="sync-btn" onclick="testConnection()">Проверить подключение</button>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>FAQ записей:</strong>
                        <span id="faq-count">0</span>
                        <button class="sync-btn" onclick="syncFAQ()">Синхронизировать FAQ</button>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <strong>Категории поддержки:</strong>
                        <span id="categories-count">0</span>
                        <button class="sync-btn" onclick="syncCategories()">Синхронизировать категории</button>
                    </div>
                </div>

                <div class="admin-section">
                    <div class="admin-title">Добавить новый FAQ</div>
                    <div class="form-group">
                        <input type="text" class="form-input" id="new-question" placeholder="Вопрос">
                    </div>
                    <div class="form-group">
                        <textarea class="form-input" id="new-answer" placeholder="Ответ" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <input type="text" class="form-input" id="new-category" placeholder="Категория">
                    </div>
                    <button class="submit-btn" onclick="addNewFAQ()">Добавить FAQ</button>
                </div>
            </div>
        </div>
    </div>

    <div id="support-tab" class="tab-content">
        <div class="container">
            <div class="header">
                <h1>База знаний</h1>
                <div class="close-btn">×</div>
            </div>

            <div class="support-categories">
                <div class="support-category" onclick="showSupportSection('faq')">
                    <div class="category-icon">❓</div>
                    <div class="category-info">
                        <div class="category-title">Частые вопросы</div>
                        <div class="category-desc">Ответы на популярные вопросы</div>
                    </div>
                    <div class="category-arrow">›</div>
                </div>

                <div class="support-category" onclick="window.open('https://t.me/MarketSuportGift', '_blank')">
                    <div class="category-icon">💬</div>
                    <div class="category-info">
                        <div class="category-title">Написать в поддержку</div>
                        <div class="category-desc">Живая помощь в Telegram</div>
                    </div>
                    <div class="category-arrow">›</div>
                </div>
            </div>

            <div id="faq-section" class="support-section" style="display: none;">
                <div class="support-header">
                    <div class="support-back" onclick="hideSupportSection()">← Назад</div>
                    <h2>Частые вопросы</h2>
                </div>

                <div class="support-content" id="faq-content">
                    <!-- FAQ загружается из базы -->
                </div>
            </div>
        </div>
    </div>

    <div id="deposit-screen" class="deposit-screen">
        <div class="deposit-content">
            <div class="deposit-header">
                <div class="deposit-back" onclick="closeDepositScreen()">←</div>
                <h1 class="deposit-title" id="deposit-title-text">Пополнение баланса</h1>
                <div style="width: 30px;"></div>
            </div>

            <div class="requisites-card">
                <p style="margin-bottom: 15px; text-align: center;" id="deposit-instruction-text">Чтобы пополнить баланс отправьте нужную сумму на реквизиты ниже 👇</p>
                
                <div class="deposit-info">
                    <div class="requisites-item">
                        <div class="requisites-title">TonKeeper</div>
                        <div class="requisites-value" onclick="copyToClipboard('UQA8t_PXSXu1mfNdwnLVS7BAv4WV6d-L8A2BTn7LA8XL2D-G')">
                            UQA8t_PXSXu1mfNdwnLVS7BAv4WV6d-L8A2BTn7LA8XL2D-G
                        </div>
                    </div>
                    
                    <div class="requisites-item">
                        <div class="requisites-title">Юмани</div>
                        <div class="requisites-value" onclick="copyToClipboard('89202555790')">
                            89202555790
                        </div>
                    </div>
                    
                    <div style="background: rgba(79, 172, 254, 0.2); padding: 15px; border-radius: 12px; margin-top: 15px; text-align: center;">
                        <strong id="deposit-wait-text">После, ожидайте 10-15 минут!</strong>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="withdraw-screen" class="withdraw-screen">
        <div class="withdraw-content">
            <div class="withdraw-header">
                <div class="withdraw-back" onclick="closeWithdrawScreen()">←</div>
                <h1 class="withdraw-title" id="withdraw-title-text">Вывод средств</h1>
                <div style="width: 30px;"></div>
            </div>

            <div class="requisites-card">
                <div class="withdraw-form">
                    <div class="form-group">
                        <label class="form-label" id="withdraw-currency-label">Валюта</label>
                        <select class="form-select" id="withdraw-currency">
                            <option value="TON">TON</option>
                            <option value="RUB">RUB</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="STARS">STARS</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" id="withdraw-amount-label">Сумма</label>
                        <input type="number" class="form-input" id="withdraw-amount" placeholder="Введите сумму" min="0">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" id="withdraw-requisites-label">Реквизиты</label>
                        <input type="text" class="form-input" id="withdraw-requisites" placeholder="Введите реквизиты для вывода">
                    </div>
                    
                    <button class="submit-btn" onclick="processWithdraw()"><span id="withdraw-button-text">Вывести</span></button>
                </div>
            </div>
        </div>
    </div>

    <div id="product-form-modal" class="product-form-modal">
        <div class="product-form-content">
            <div class="product-form-header">
                <div class="product-form-back" onclick="closeProductFormModal()">←</div>
                <h1 class="product-form-title">Добавление товара</h1>
                <div style="width: 30px;"></div>
            </div>

            <div class="instruction-card">
                <h3 style="margin-bottom: 15px; text-align: center;">Инструкция</h3>
                <div class="instruction-step">
                    Чтобы выложить товар на продажу передайте его нашей Тех. Поддержке (Realyer) 
                    <a href="https://t.me/MarketSuportGift" target="_blank" style="color: #4facfe; text-decoration: none;">@MarketSuportGift</a>
                </div>
                <div class="instruction-step">
                    После передачи заполните анкету товара ниже
                </div>
            </div>

            <div class="product-form">
                <div class="form-group">
                    <label class="form-label">Тип товара</label>
                    <select class="form-select" id="product-type">
                        <option value="gift">Подарок</option>
                        <option value="crypto">Криптовалюта</option>
                        <option value="other">Другое</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Название товара</label>
                    <input type="text" class="form-input" id="product-name" placeholder="Введите название товара">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Ссылка на товар <span style="color: #ff6b6b;">*</span></label>
                    <input type="text" class="form-input" id="product-link" placeholder="https://example.com/product">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Фото товара (необязательно)</label>
                    <div class="product-image-preview" onclick="document.getElementById('product-image-upload').click()">
                        <div class="upload-placeholder">
                            <div class="upload-icon">📷</div>
                            <div>Нажмите для загрузки фото</div>
                        </div>
                        <img id="product-image-preview" style="display: none;">
                    </div>
                    <input type="file" id="product-image-upload" accept="image/*" style="display: none;">
                </div>
                
                <div class="form-group">
                    <label class="form-label">Цена</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="number" class="form-input" id="product-price" placeholder="0.00" min="0" step="0.01" style="flex: 2;">
                        <select class="form-select" id="product-currency" style="flex: 1;">
                            <option value="TON">TON</option>
                            <option value="RUB">RUB</option>
                            <option value="USD">USD</option>
                            <option value="EUR">EUR</option>
                            <option value="STARS">STARS</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-actions">
                    <button class="action-btn secondary" onclick="closeProductFormModal()">Отмена</button>
                    <button class="action-btn primary" onclick="createProduct()">Создать товар</button>
                </div>
            </div>
        </div>
    </div>

    <div id="language-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title" id="language-modal-title">Выберите язык</div>
            <div class="modal-option active" data-value="ru">Русский</div>
            <div class="modal-option" data-value="en">English</div>
            <div class="modal-actions">
                <button class="modal-btn modal-cancel" onclick="closeModal('language-modal')"><span id="cancel-text">Отмена</span></button>
                <button class="modal-btn modal-save" onclick="saveLanguage()"><span id="save-text">Сохранить</span></button>
            </div>
        </div>
    </div>

    <div id="currency-modal" class="modal">
        <div class="modal-content">
            <div class="modal-title" id="currency-modal-title">Выберите валюту</div>
            <div class="modal-option active" data-value="RUB">RUB - Российский рубль</div>
            <div class="modal-option" data-value="USD">USD - Доллар США</div>
            <div class="modal-option" data-value="EUR">EUR - Евро</div>
            <div class="modal-option" data-value="TON">TON - Toncoin</div>
            <div class="modal-option" data-value="STARS">STARS - Stars</div>
            <div class="modal-actions">
                <button class="modal-btn modal-cancel" onclick="closeModal('currency-modal')"><span id="cancel-text-2">Отмена</span></button>
                <button class="modal-btn modal-save" onclick="saveCurrency()"><span id="save-text-2">Сохранить</span></button>
            </div>
        </div>
    </div>

    <div id="notification-container"></div>

    <div class="bottom-nav">
        <div class="nav-item active" onclick="showTab('market-tab')">
            <div class="nav-icon nav-market"></div>
            <div id="nav-market-text">Маркет</div>
        </div>
        <div class="nav-item" onclick="showTab('gifts-tab')">
            <div class="nav-icon nav-gifts"></div>
            <div id="nav-gifts-text">Подарки</div>
        </div>
        <div class="nav-item" onclick="showTab('requisites-tab')">
            <div class="nav-icon nav-wallet"></div>
            <div id="nav-wallet-text">Реквизиты</div>
        </div>
        <div class="nav-item" onclick="showTab('support-tab')">
            <div class="nav-icon nav-support"></div>
            <div id="nav-support-text">Поддержка</div>
        </div>
        <div class="nav-item" onclick="showTab('profile-tab')">
            <div class="nav-icon nav-profile"></div>
            <div id="nav-profile-text">Профиль</div>
        </div>
    </div>

    <script>
        // ПОЛНЫЙ СПИСОК NFT ТОВАРОВ (99 товаров)
        const realGifts = [
            // 1-15
            { id: "signet_ring_001", name: "Signet Ring", priceTON: "15.2", color: "rgba(79, 172, 254, 0.3)", border: "rgba(79, 172, 254, 0.7)", icon: "💍", type: "nft" },
            { id: "skull_flower_002", name: "Skull Flower", priceTON: "8.8", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "💀", type: "nft" },
            { id: "snow_mittens_003", name: "Snow Mittens", priceTON: "3.5", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "🧤", type: "nft" },
            { id: "spiced_wine_004", name: "Spiced Wine", priceTON: "12.1", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🍷", type: "nft" },
            { id: "spy_agaric_005", name: "Spy Agaric", priceTON: "7.5", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🍄", type: "nft" },
            { id: "star_notepad_006", name: "Star Notepad", priceTON: "4.8", color: "rgba(255, 235, 59, 0.3)", border: "rgba(255, 235, 59, 0.7)", icon: "📔", type: "nft" },
            { id: "swiss_watch_007", name: "Swiss Watch", priceTON: "25.5", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "⌚", type: "nft" },
            { id: "trapped_heart_008", name: "Trapped Heart", priceTON: "18.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "💔", type: "nft" },
            { id: "vintage_cigar_009", name: "Vintage Cigar", priceTON: "22.8", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "🚬", type: "nft" },
            { id: "voodoo_doll_010", name: "Voodoo Doll", priceTON: "14.1", color: "rgba(103, 58, 183, 0.3)", border: "rgba(103, 58, 183, 0.7)", icon: "🪆", type: "nft" },
            { id: "witch_hat_011", name: "Witch Hat", priceTON: "9.7", color: "rgba(63, 81, 181, 0.3)", border: "rgba(63, 81, 181, 0.7)", icon: "🧙", type: "nft" },
            { id: "lunar_snake_012", name: "Lunar Snake", priceTON: "16.4", color: "rgba(0, 150, 136, 0.3)", border: "rgba(0, 150, 136, 0.7)", icon: "🐍", type: "nft" },
            { id: "mad_pumpkin_013", name: "Mad Pumpkin", priceTON: "6.3", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🎃", type: "nft" },
            { id: "magic_potion_014", name: "Magic Potion", priceTON: "28.6", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🧪", type: "nft" },
            { id: "mini_oscar_015", name: "Mini Oscar", priceTON: "35.2", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🏆", type: "nft" },

            // 16-30
            { id: "party_sparkler_016", name: "Party Sparkler", priceTON: "5.8", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "🎇", type: "nft" },
            { id: "perfume_bottle_017", name: "Perfume Bottle", priceTON: "12.5", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "🧴", type: "nft" },
            { id: "plush_pepe_018", name: "Plush Pepe", priceTON: "8.2", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🐸", type: "nft" },
            { id: "precious_peach_019", name: "Precious Peach", priceTON: "7.9", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🍑", type: "nft" },
            { id: "santa_hat_020", name: "Santa Hat", priceTON: "4.5", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🎅", type: "nft" },
            { id: "scared_cat_021", name: "Scared Cat", priceTON: "6.7", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "🐱", type: "nft" },
            { id: "sharp_tongue_022", name: "Sharp Tongue", priceTON: "9.3", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "👅", type: "nft" },
            { id: "hex_pot_023", name: "Hex Pot", priceTON: "11.2", color: "rgba(103, 58, 183, 0.3)", border: "rgba(103, 58, 183, 0.7)", icon: "🍯", type: "nft" },
            { id: "homemade_cake_024", name: "Homemade Cake", priceTON: "8.8", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🍰", type: "nft" },
            { id: "hypno_lollipop_025", name: "Hypno Lollipop", priceTON: "5.5", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "🍭", type: "nft" },
            { id: "ion_gem_026", name: "Ion Gem", priceTON: "22.4", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "💎", type: "nft" },
            { id: "jelly_bunny_027", name: "Jelly Bunny", priceTON: "7.1", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "🐰", type: "nft" },
            { id: "jester_hat_028", name: "Jester Hat", priceTON: "10.3", color: "rgba(255, 235, 59, 0.3)", border: "rgba(255, 235, 59, 0.7)", icon: "🎭", type: "nft" },
            { id: "jingle_bells_029", name: "Jingle Bells", priceTON: "6.2", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🔔", type: "nft" },
            { id: "kissed_frog_030", name: "Kissed Frog", priceTON: "13.7", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🐸", type: "nft" },

            // 31-45
            { id: "lol_pop_031", name: "Lol Pop", priceTON: "4.9", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🍬", type: "nft" },
            { id: "love_candle_032", name: "Love Candle", priceTON: "8.4", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🕯️", type: "nft" },
            { id: "cookie_heart_033", name: "Cookie Heart", priceTON: "5.6", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "🍪", type: "nft" },
            { id: "crystal_ball_034", name: "Crystal Ball", priceTON: "19.8", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "🔮", type: "nft" },
            { id: "mooo_035", name: "MOOO", priceTON: "9.1", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "🐄", type: "nft" },
            { id: "desk_calendar_036", name: "Desk Calendar", priceTON: "7.3", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "📅", type: "nft" },
            { id: "durovs_cap_037", name: "Durovs Cap", priceTON: "25.9", color: "rgba(63, 81, 181, 0.3)", border: "rgba(63, 81, 181, 0.7)", icon: "🧢", type: "nft" },
            { id: "eternal_candle_038", name: "Eternal Candle", priceTON: "14.6", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🕯️", type: "nft" },
            { id: "eternal_rose_039", name: "Eternal Rose", priceTON: "16.8", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🌹", type: "nft" },
            { id: "evil_eye_040", name: "Evil Eye", priceTON: "11.5", color: "rgba(103, 58, 183, 0.3)", border: "rgba(103, 58, 183, 0.7)", icon: "👁️", type: "nft" },
            { id: "flying_broom_041", name: "Flying Broom", priceTON: "13.2", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "🧹", type: "nft" },
            { id: "genie_lamp_042", name: "Genie Lamp", priceTON: "29.7", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "💡", type: "nft" },
            { id: "ginger_cookie_043", name: "Ginger Cookie", priceTON: "5.2", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🍪", type: "nft" },
            { id: "sleigh_bell_044", name: "Sleigh Bell", priceTON: "6.8", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🔔", type: "nft" },
            { id: "sakura_flower_045", name: "Sakura Flower", priceTON: "10.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🌸", type: "nft" },

            // 46-60
            { id: "top_hat_046", name: "Top Hat", priceTON: "12.7", color: "rgba(33, 33, 33, 0.3)", border: "rgba(33, 33, 33, 0.7)", icon: "🎩", type: "nft" },
            { id: "diamond_ring_047", name: "Diamond Ring", priceTON: "45.3", color: "rgba(79, 172, 254, 0.3)", border: "rgba(79, 172, 254, 0.7)", icon: "💎", type: "nft" },
            { id: "love_potion_048", name: "Love Potion", priceTON: "18.4", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🧪", type: "nft" },
            { id: "toy_bear_049", name: "Toy Bear", priceTON: "8.6", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🧸", type: "nft" },
            { id: "loot_bag_050", name: "Loot Bag", priceTON: "15.7", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "🎒", type: "nft" },
            { id: "astral_shard_051", name: "Astral Shard", priceTON: "32.1", color: "rgba(103, 58, 183, 0.3)", border: "rgba(103, 58, 183, 0.7)", icon: "✨", type: "nft" },
            { id: "happy_052", name: "HAPPY", priceTON: "7.5", color: "rgba(255, 235, 59, 0.3)", border: "rgba(255, 235, 59, 0.7)", icon: "😊", type: "nft" },
            { id: "bday_053", name: "BdAy", priceTON: "9.8", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "🎂", type: "nft" },
            { id: "bday_candle_054", name: "BDay Candle", priceTON: "4.3", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🕯️", type: "nft" },
            { id: "berry_box_055", name: "Berry Box", priceTON: "8.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🍓", type: "nft" },
            { id: "bunny_muffin_056", name: "Bunny Muffin", priceTON: "6.4", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🧁", type: "nft" },
            { id: "tama_gadget_057", name: "Tama GadGet", priceTON: "22.3", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "📱", type: "nft" },
            { id: "candy_cane_058", name: "Candy Cane", priceTON: "5.1", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🍬", type: "nft" },
            { id: "snow_globe_059", name: "Snow Globe", priceTON: "11.8", color: "rgba(79, 172, 254, 0.3)", border: "rgba(79, 172, 254, 0.7)", icon: "🔮", type: "nft" },
            { id: "electric_skull_060", name: "Electric Skull", priceTON: "17.6", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "💀", type: "nft" },

            // 61-75
            { id: "winter_wreath_061", name: "Winter Wreath", priceTON: "9.4", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🎄", type: "nft" },
            { id: "neko_helmet_062", name: "Neko Helmet", priceTON: "14.2", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "🐱", type: "nft" },
            { id: "record_player_063", name: "Record Player", priceTON: "23.7", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "🎵", type: "nft" },
            { id: "jack_in_the_box_064", name: "Jack In The Box", priceTON: "12.5", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🎁", type: "nft" },
            { id: "easter_egg_065", name: "Easter Egg", priceTON: "7.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🥚", type: "nft" },
            { id: "holiday_drink_066", name: "Holiday Drink", priceTON: "8.3", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🍹", type: "nft" },
            { id: "xmas_stocking_067", name: "Xmas Stocking", priceTON: "6.7", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🧦", type: "nft" },
            { id: "snake_box_068", name: "Snake Box", priceTON: "13.4", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🐍", type: "nft" },
            { id: "pet_snake_069", name: "Pet Snake", priceTON: "16.9", color: "rgba(0, 150, 136, 0.3)", border: "rgba(0, 150, 136, 0.7)", icon: "🐍", type: "nft" },
            { id: "big_year_070", name: "Big Year", priceTON: "28.5", color: "rgba(255, 235, 59, 0.3)", border: "rgba(255, 235, 59, 0.7)", icon: "📅", type: "nft" },
            { id: "heart_locket_071", name: "Heart Locket", priceTON: "14.8", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🔒", type: "nft" },
            { id: "bow_tie_072", name: "Bow Tie", priceTON: "9.6", color: "rgba(63, 81, 181, 0.3)", border: "rgba(63, 81, 181, 0.7)", icon: "🎀", type: "nft" },
            { id: "heroic_helmet_073", name: "Heroic Helmet", priceTON: "21.3", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "⛑️", type: "nft" },
            { id: "nail_bracelet_074", name: "Nail Bracelet", priceTON: "11.2", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "📿", type: "nft" },
            { id: "restless_jar_075", name: "Restless Jar", priceTON: "15.7", color: "rgba(103, 58, 183, 0.3)", border: "rgba(103, 58, 183, 0.7)", icon: "🏺", type: "nft" },

            // 76-90
            { id: "light_sword_076", name: "Light Sword", priceTON: "26.4", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "⚔️", type: "nft" },
            { id: "gem_signet_077", name: "Gem Signet", priceTON: "34.2", color: "rgba(79, 172, 254, 0.3)", border: "rgba(79, 172, 254, 0.7)", icon: "💎", type: "nft" },
            { id: "bonded_ring_078", name: "Bonded Ring", priceTON: "19.8", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "💍", type: "nft" },
            { id: "lush_bouquet_079", name: "Lush Bouquet", priceTON: "16.5", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "💐", type: "nft" },
            { id: "cupid_charm_080", name: "CupidCharm", priceTON: "13.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🏹", type: "nft" },
            { id: "joyful_bundle_081", name: "JoyfulBundle", priceTON: "22.1", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🎁", type: "nft" },
            { id: "valentine_box_082", name: "ValentineBox", priceTON: "17.4", color: "rgba(255, 87, 34, 0.3)", border: "rgba(255, 87, 34, 0.7)", icon: "💝", type: "nft" },
            { id: "whip_cupcake_083", name: "WhipCupcake", priceTON: "8.7", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🧁", type: "nft" },
            { id: "low_rider_084", name: "LowRider", priceTON: "31.5", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "🚗", type: "nft" },
            { id: "swag_bag_085", name: "SwagBag", priceTON: "14.6", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "🛍️", type: "nft" },
            { id: "snoop_cigar_086", name: "SnoopCigar", priceTON: "25.8", color: "rgba(63, 81, 181, 0.3)", border: "rgba(63, 81, 181, 0.7)", icon: "🚬", type: "nft" },
            { id: "snoop_dogg_087", name: "SnoopDogg", priceTON: "42.3", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "🐕", type: "nft" },
            { id: "westside_sign_088", name: "WestsideSign", priceTON: "18.9", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "🪧", type: "nft" },
            { id: "cupid_charm_089", name: "CupidCharm", priceTON: "13.9", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "🏹", type: "nft" },
            { id: "jolly_chimp_090", name: "JollyChimp", priceTON: "24.7", color: "rgba(255, 152, 0, 0.3)", border: "rgba(255, 152, 0, 0.7)", icon: "🐒", type: "nft" },

            // 91-99
            { id: "stellar_rocket_091", name: "StellarRocket", priceTON: "38.2", color: "rgba(33, 150, 243, 0.3)", border: "rgba(33, 150, 243, 0.7)", icon: "🚀", type: "nft" },
            { id: "moon_pendant_092", name: "MoonPendant", priceTON: "16.8", color: "rgba(156, 39, 176, 0.3)", border: "rgba(156, 39, 176, 0.7)", icon: "🌙", type: "nft" },
            { id: "ionic_dryer_093", name: "IonicDryer", priceTON: "27.3", color: "rgba(158, 158, 158, 0.3)", border: "rgba(158, 158, 158, 0.7)", icon: "💨", type: "nft" },
            { id: "input_key_094", name: "InputKey", priceTON: "19.5", color: "rgba(255, 193, 7, 0.3)", border: "rgba(255, 193, 7, 0.7)", icon: "🔑", type: "nft" },
            { id: "artisan_brick_095", name: "ArtisanBrick", priceTON: "14.1", color: "rgba(121, 85, 72, 0.3)", border: "rgba(121, 85, 72, 0.7)", icon: "🧱", type: "nft" },
            { id: "mighty_arm_096", name: "MightyArm", priceTON: "29.8", color: "rgba(244, 67, 54, 0.3)", border: "rgba(244, 67, 54, 0.7)", icon: "💪", type: "nft" },
            { id: "sky_stilettos_097", name: "SkyStilettos", priceTON: "22.6", color: "rgba(233, 30, 99, 0.3)", border: "rgba(233, 30, 99, 0.7)", icon: "👠", type: "nft" },
            { id: "fresh_socks_098", name: "FreshSocks", priceTON: "8.9", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🧦", type: "nft" },
            { id: "clover_pin_099", name: "CloverPin", priceTON: "12.4", color: "rgba(76, 175, 80, 0.3)", border: "rgba(76, 175, 80, 0.7)", icon: "🍀", type: "nft" }
        ];

        // ВСЕ ОСТАЛЬНЫЕ ПЕРЕМЕННЫЕ И ФУНКЦИИ
        const currencies = [
            { symbol: "TON", rate: 1 },
            { symbol: "RUB", rate: 185 },
            { symbol: "USD", rate: 2.1 },
            { symbol: "EUR", rate: 1.9 },
            { symbol: "STARS", rate: 120 }
        ];

        const sellers = ["trepal_fertyya", "xander_zolt", "kryton_n7", "zephyr_vortex", "orion_stark", "nova_spectre", "quantum_flux", "cypher_nexus", "astra_void"];

        const translations = {
            ru: {
                marketTitle: "Фильтры",
                modelFilter: "Модель",
                currencyFilter: "Валюта",
                refresh: "Обновить",
                loading: "Загрузка...",
                giftsTitle: "Подарки",
                noGifts: "У вас пока нет подарков",
                requisitesTitle: "Реквизиты",
                balanceLabel: "Баланс:",
                deposit: "Пополнить",
                withdraw: "Вывести",
                historyTitle: "История операций",
                noOperations: "Пока нет операций",
                profileTitle: "Профиль",
                balanceTitle: "Баланс",
                giftsCount: "Подарков",
                sold: "Продано",
                totalVolume: "Общий объем торгов",
                settingsTitle: "Настройки",
                language: "Язык",
                currency: "Валюта",
                support: "Поддержка",
                depositTitle: "Пополнение баланса",
                depositInstruction: "Чтобы пополнить баланс отправьте нужную сумму на реквизиты ниже 👇",
                depositWait: "После, ожидайте 10-15 минут!",
                withdrawTitle: "Вывод средств",
                withdrawCurrency: "Валюта",
                withdrawAmount: "Сумма",
                withdrawRequisites: "Реквизиты",
                withdrawButton: "Вывести",
                languageModalTitle: "Выберите язык",
                currencyModalTitle: "Выберите валюту",
                cancel: "Отмена",
                save: "Сохранить",
                navMarket: "Маркет",
                navGifts: "Подарки",
                navWallet: "Реквизиты",
                navProfile: "Профиль",
                navSupport: "Поддержка",
                allModels: "Все модели",
                allCurrencies: "Все валюты",
                buy: "Купить",
                close: "Закрыть",
                seller: "Продавец",
                addedToCart: "Добавлено в корзину:",
                purchaseSuccess: "Покупка успешна! Вы приобрели",
                insufficientFunds: "Недостаточно средств",
                nameChanged: "Имя успешно изменено!",
                copied: "Скопировано в буфер обмена!",
                copyError: "Ошибка копирования",
                withdrawRequest: "Заявка на вывод принята! Ожидайте обработки.",
                enterAmount: "Введите корректную сумму",
                enterRequisites: "Введите реквизиты для вывода",
                shareLink: "Поделиться ссылкой",
                shareProduct: "Поделиться товаром",
                productSold: "Товар продан!",
                sellerNotification: "Ваш товар купили!",
                sellerBalanceUpdated: "Баланс пополнен"
            },
            en: {
                marketTitle: "Filters",
                modelFilter: "Model",
                currencyFilter: "Currency",
                refresh: "Refresh",
                loading: "Loading...",
                giftsTitle: "Gifts",
                noGifts: "You have no gifts yet",
                requisitesTitle: "Requisites",
                balanceLabel: "Balance:",
                deposit: "Deposit",
                withdraw: "Withdraw",
                historyTitle: "Transaction History",
                noOperations: "No transactions yet",
                profileTitle: "Profile",
                balanceTitle: "Balance",
                giftsCount: "Gifts",
                sold: "Sold",
                totalVolume: "Total trading volume",
                settingsTitle: "Settings",
                language: "Language",
                currency: "Currency",
                support: "Support",
                depositTitle: "Deposit Funds",
                depositInstruction: "To deposit funds, send the required amount to the details below 👇",
                depositWait: "After that, wait 10-15 minutes!",
                withdrawTitle: "Withdraw Funds",
                withdrawCurrency: "Currency",
                withdrawAmount: "Amount",
                withdrawRequisites: "Requisites",
                withdrawButton: "Withdraw",
                languageModalTitle: "Choose Language",
                currencyModalTitle: "Choose Currency",
                cancel: "Cancel",
                save: "Save",
                navMarket: "Market",
                navGifts: "Gifts",
                navWallet: "Requisites",
                navProfile: "Profile",
                navSupport: "Support",
                allModels: "All models",
                allCurrencies: "All currencies",
                buy: "Buy",
                close: "Close",
                seller: "Seller",
                addedToCart: "Added to cart:",
                purchaseSuccess: "Purchase successful! You bought",
                insufficientFunds: "Insufficient funds",
                nameChanged: "Name successfully changed!",
                copied: "Copied to clipboard!",
                copyError: "Copy error",
                withdrawRequest: "Withdrawal request accepted! Please wait for processing.",
                enterAmount: "Enter correct amount",
                enterRequisites: "Enter withdrawal requisites",
                shareLink: "Share link",
                shareProduct: "Share product",
                productSold: "Product sold!",
                sellerNotification: "Your product was purchased!",
                sellerBalanceUpdated: "Balance updated"
            }
        };

        let currentProducts = [];
        let userBalance = 0;
        let infiniteBalance = false;
        let userName = "Пользователь";
        let currentLanguage = "ru";
        let selectedCurrencySetting = "RUB";
        let cartItems = [];
        
        let userGifts = {
            listed: [],
            unlisted: []
        };

        // Переменные для фильтров
        let selectedModelFilter = "all";
        let selectedCurrencyFilter = "all";

        // ГЛОБАЛЬНАЯ БАЗА ТОВАРОВ
        const globalProductsDatabase = {};
        realGifts.forEach(product => {
            globalProductsDatabase[product.id] = product;
        });

        // ФУНКЦИИ ДЛЯ ФИЛЬТРОВ
        function toggleFilterDropdown(filterId) {
            const dropdown = document.getElementById(filterId + '-dropdown');
            const isVisible = dropdown.style.display === 'block';
            
            document.querySelectorAll('.filter-dropdown').forEach(dropdown => {
                dropdown.style.display = 'none';
            });
            
            if (!isVisible) {
                dropdown.style.display = 'block';
                event.stopPropagation();
            }
        }

        function selectFilterOption(filterType, value, text) {
            if (filterType === 'model') {
                selectedModelFilter = value;
                document.getElementById('model-filter-text').textContent = text;
            } else if (filterType === 'currency') {
                selectedCurrencyFilter = value;
                document.getElementById('currency-filter-text').textContent = text;
            }
            
            const dropdown = document.getElementById(filterType + '-dropdown');
            dropdown.querySelectorAll('.filter-option').forEach(option => {
                option.classList.remove('active');
            });
            event.target.classList.add('active');
            
            dropdown.style.display = 'none';
            refreshCatalog();
            event.stopPropagation();
        }

        function refreshCatalog() {
            const list = document.getElementById('products-list');
            list.innerHTML = '';
            
            currentProducts = [...realGifts];
            
            let filteredProducts = currentProducts;
            
            if (selectedModelFilter !== "all") {
                filteredProducts = filteredProducts.filter(product => product.name === selectedModelFilter);
            }
            
            if (selectedCurrencyFilter !== "all") {
                // Фильтрация по валюте
            }
            
            filteredProducts.forEach((product, index) => {
                const currency = currencies[Math.floor(Math.random() * currencies.length)];
                const price = Math.round(parseFloat(product.priceTON) * currency.rate);
                const firstLetter = product.name.charAt(0).toUpperCase();
                
                const card = document.createElement('div');
                card.className = 'product-card';
                card.style.setProperty('--card-color', product.color);
                card.style.setProperty('--card-border', product.border);
                card.onclick = () => showProductModal(product, currency);
                
                card.innerHTML = `
                    <div class="product-info">
                        <div class="product-icon">${firstLetter}</div>
                        <div class="product-details">
                            <div class="product-name">${product.name}</div>
                            <div class="product-id">ID: ${product.id}</div>
                        </div>
                    </div>
                    <div class="product-price-container">
                        <div class="product-price">
                            ${price} ${currency.symbol}
                        </div>
                        <button class="cart-btn" onclick="event.stopPropagation(); addToCart('${product.name}', ${parseFloat(product.priceTON)}, '${product.id}')">
                            <div class="cart-icon"></div>
                        </button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        // ВСЕ ОСТАЛЬНЫЕ ФУНКЦИИ
        function showTab(tabName) {
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.nav-item').forEach(nav => {
                nav.classList.remove('active');
            });
            
            document.getElementById(tabName).classList.add('active');
            
            if (tabName === 'market-tab') {
                document.querySelectorAll('.nav-item')[0].classList.add('active');
                refreshCatalog();
            } else if (tabName === 'gifts-tab') {
                document.querySelectorAll('.nav-item')[1].classList.add('active');
                refreshUserGifts();
                refreshCart();
            } else if (tabName === 'requisites-tab') {
                document.querySelectorAll('.nav-item')[2].classList.add('active');
            } else if (tabName === 'support-tab') {
                document.querySelectorAll('.nav-item')[3].classList.add('active');
                loadFAQ();
            } else if (tabName === 'profile-tab') {
                document.querySelectorAll('.nav-item')[4].classList.add('active');
            } else if (tabName === 'settings-tab') {
                document.querySelectorAll('.nav-item')[4].classList.add('active');
            }
        }

        function showGiftTab(tabName) {
            document.querySelectorAll('.gift-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.gift-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            document.getElementById(tabName + '-content').style.display = 'block';
            
            if (tabName === 'my-gifts') {
                refreshUserGifts();
            } else if (tabName === 'cart') {
                refreshCart();
            }
        }

        function showSubTab(tabName) {
            document.querySelectorAll('.sub-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.sub-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            document.getElementById(tabName + '-tab').classList.add('active');
            document.getElementById(tabName + '-gifts').style.display = 'block';
            
            refreshUserGifts();
        }

        function refreshUserGifts() {
            const listedList = document.getElementById('listed-products-list');
            const unlistedList = document.getElementById('unlisted-products-list');
            const noListed = document.getElementById('no-listed-gifts');
            const noUnlisted = document.getElementById('no-unlisted-gifts');
            
            listedList.innerHTML = '';
            unlistedList.innerHTML = '';
            
            document.getElementById('gifts-count').textContent = userGifts.listed.length + userGifts.unlisted.length;
            document.getElementById('sold-count').textContent = userGifts.listed.length;
            
            if (userGifts.listed.length === 0) {
                noListed.style.display = 'block';
            } else {
                noListed.style.display = 'none';
                userGifts.listed.forEach((gift, index) => {
                    const card = createUserGiftCard(gift, true);
                    listedList.appendChild(card);
                });
            }
            
            if (userGifts.unlisted.length === 0) {
                noUnlisted.style.display = 'block';
            } else {
                noUnlisted.style.display = 'none';
                userGifts.unlisted.forEach((gift, index) => {
                    const card = createUserGiftCard(gift, false);
                    unlistedList.appendChild(card);
                });
            }
        }

        function createUserGiftCard(gift, isListed) {
            const card = document.createElement('div');
            card.className = 'product-card';
            card.style.setProperty('--card-color', gift.color || "rgba(79, 172, 254, 0.3)");
            card.style.setProperty('--card-border', gift.border || "rgba(79, 172, 254, 0.7)");
            const firstLetter = gift.name.charAt(0).toUpperCase();
            
            let iconContent = '';
            if (gift.image) {
                iconContent = `<img src="${gift.image}" style="width: 40px; height: 40px; object-fit: cover; border-radius: 8px;">`;
            } else {
                iconContent = `<div class="product-icon">${firstLetter}</div>`;
            }
            
            if (isListed) {
                card.onclick = () => showUserProductModal(gift, true);
                card.innerHTML = `
                    <div class="product-info">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            ${iconContent}
                            <div>
                                <div class="product-name">${gift.name}</div>
                                <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-top: 5px;">Продавец: ${userName}</div>
                            </div>
                        </div>
                    </div>
                    <div class="product-price-container">
                        <div class="product-price">
                            ${gift.price} ${gift.currency}
                        </div>
                        <div style="display: flex; gap: 5px;">
                            <button class="cart-btn" onclick="event.stopPropagation(); showShareLink('${gift.id}')" style="background: rgba(76, 175, 80, 0.8);">
                                <div class="action-icon icon-share"></div>
                            </button>
                            <button class="cart-btn" onclick="event.stopPropagation(); removeFromMarket('${gift.id}')" style="background: rgba(244, 67, 54, 0.8);">
                                <div class="action-icon icon-remove"></div>
                            </button>
                        </div>
                    </div>
                `;
            } else {
                card.onclick = () => showUserProductModal(gift, false);
                card.innerHTML = `
                    <div class="product-info">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            ${iconContent}
                            <div>
                                <div class="product-name">${gift.name}</div>
                            </div>
                        </div>
                    </div>
                    <div class="product-price-container">
                        <div class="product-price">
                            ${gift.price} ${gift.currency}
                        </div>
                        <button class="cart-btn" onclick="event.stopPropagation(); addToMarket('${gift.id}')">
                            <div class="action-icon icon-add-market"></div>
                        </button>
                    </div>
                `;
            }
            
            return card;
        }

        function showProductModal(product, currency) {
            const modal = document.createElement('div');
            modal.className = 'product-modal';
            modal.innerHTML = `
                <div class="product-modal-content">
                    <div class="product-modal-header">
                        <h2 class="product-modal-title">${product.name}</h2>
                        <div class="product-modal-close" onclick="this.closest('.product-modal').remove()">×</div>
                    </div>
                    
                    <div class="product-modal-image">
                        <div class="letter-icon">${product.name.charAt(0)}</div>
                    </div>
                    
                    <div class="product-modal-details">
                        <div class="product-modal-price">
                            ${Math.round(parseFloat(product.priceTON) * currency.rate)} ${currency.symbol}
                        </div>
                        <div class="product-modal-description">
                            Уникальный NFT товар из коллекции Portals Market. 
                            ID: ${product.id}
                        </div>
                    </div>
                    
                    <div class="product-modal-actions">
                        <button class="product-modal-btn product-modal-cancel" onclick="this.closest('.product-modal').remove()">Закрыть</button>
                        <button class="product-modal-btn product-modal-buy" onclick="buyProduct('${product.id}', '${product.name}', ${parseFloat(product.priceTON)}, '${currency.symbol}')">Купить</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function addToCart(productName, price, productId) {
            cartItems.push({
                name: productName,
                price: price,
                id: productId,
                currency: 'TON'
            });
            saveToDatabase();
            refreshCart();
            showNotification(`${productName} добавлен в корзину!`, 'success');
        }

        function refreshCart() {
            const container = document.getElementById('cart-items-container');
            const emptyCart = document.getElementById('empty-cart');
            const totalContainer = document.getElementById('cart-total-container');
            const totalAmount = document.getElementById('cart-total-amount');
            
            container.innerHTML = '';
            
            if (cartItems.length === 0) {
                emptyCart.style.display = 'block';
                totalContainer.style.display = 'none';
            } else {
                emptyCart.style.display = 'none';
                totalContainer.style.display = 'block';
                
                let total = 0;
                cartItems.forEach((item, index) => {
                    total += item.price;
                    const cartItem = document.createElement('div');
                    cartItem.className = 'cart-item';
                    cartItem.innerHTML = `
                        <div class="cart-item-info">
                            <div class="cart-item-name">${item.name}</div>
                            <div class="cart-item-price">${item.price} ${item.currency}</div>
                        </div>
                        <button class="cart-remove-btn" onclick="removeFromCart(${index})">
                            <div class="action-icon icon-remove"></div>
                        </button>
                    `;
                    container.appendChild(cartItem);
                });
                
                totalAmount.textContent = total.toFixed(2);
            }
        }

        function removeFromCart(index) {
            cartItems.splice(index, 1);
            saveToDatabase();
            refreshCart();
        }

        function buyCartItems() {
            if (cartItems.length === 0) return;
            
            const total = cartItems.reduce((sum, item) => sum + item.price, 0);
            
            if (!infiniteBalance && userBalance < total) {
                showNotification('Недостаточно средств!', 'error');
                return;
            }
            
            if (!infiniteBalance) {
                userBalance -= total;
            }
            
            // Добавляем товары в невыставленные подарки
            cartItems.forEach(item => {
                userGifts.unlisted.push({
                    id: item.id,
                    name: item.name,
                    price: item.price,
                    currency: item.currency,
                    color: "rgba(79, 172, 254, 0.3)",
                    border: "rgba(79, 172, 254, 0.7)"
                });
            });
            
            cartItems = [];
            saveToDatabase();
            refreshCart();
            refreshUserGifts();
            updateBalanceDisplay();
            
            showNotification(`Покупка успешна! Куплено ${cartItems.length} товаров`, 'success');
        }

        function buyProduct(productId, productName, price, currency) {
            if (!infiniteBalance && userBalance < price) {
                showNotification('Недостаточно средств!', 'error');
                return;
            }
            
            if (!infiniteBalance) {
                userBalance -= price;
            }
            
            // Добавляем товар в невыставленные подарки
            userGifts.unlisted.push({
                id: productId,
                name: productName,
                price: price,
                currency: currency,
                color: "rgba(79, 172, 254, 0.3)",
                border: "rgba(79, 172, 254, 0.7)"
            });
            
            saveToDatabase();
            refreshUserGifts();
            updateBalanceDisplay();
            
            showNotification(`Покупка успешна! Вы приобрели ${productName}`, 'success');
            
            // Закрываем модальное окно
            document.querySelector('.product-modal').remove();
        }

        function showUserProductModal(gift, isListed) {
            const modal = document.createElement('div');
            modal.className = 'product-modal';
            modal.innerHTML = `
                <div class="product-modal-content">
                    <div class="product-modal-header">
                        <h2 class="product-modal-title">${gift.name}</h2>
                        <div class="product-modal-close" onclick="this.closest('.product-modal').remove()">×</div>
                    </div>
                    
                    <div class="product-modal-image">
                        <div class="letter-icon">${gift.name.charAt(0)}</div>
                    </div>
                    
                    <div class="product-modal-details">
                        <div class="product-modal-price">
                            ${gift.price} ${gift.currency}
                        </div>
                        <div class="product-modal-description">
                            ${isListed ? 'Товар выставлен на продажу' : 'Товар в вашей коллекции'}
                            <br>ID: ${gift.id}
                        </div>
                    </div>
                    
                    <div class="product-modal-actions">
                        <button class="product-modal-btn product-modal-cancel" onclick="this.closest('.product-modal').remove()">Закрыть</button>
                        ${isListed ? 
                            `<button class="product-modal-btn product-modal-buy" onclick="removeFromMarket('${gift.id}'); this.closest('.product-modal').remove()">Снять с продажи</button>` :
                            `<button class="product-modal-btn product-modal-buy" onclick="addToMarket('${gift.id}'); this.closest('.product-modal').remove()">Выставить на продажу</button>`
                        }
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function addToMarket(giftId) {
            const giftIndex = userGifts.unlisted.findIndex(g => g.id === giftId);
            if (giftIndex !== -1) {
                const gift = userGifts.unlisted[giftIndex];
                userGifts.unlisted.splice(giftIndex, 1);
                userGifts.listed.push(gift);
                saveToDatabase();
                refreshUserGifts();
                showNotification('Товар выставлен на продажу!', 'success');
            }
        }

        function removeFromMarket(giftId) {
            const giftIndex = userGifts.listed.findIndex(g => g.id === giftId);
            if (giftIndex !== -1) {
                const gift = userGifts.listed[giftIndex];
                userGifts.listed.splice(giftIndex, 1);
                userGifts.unlisted.push(gift);
                saveToDatabase();
                refreshUserGifts();
                showNotification('Товар снят с продажи!', 'success');
            }
        }

        function showShareLink(productId) {
            const shareLink = `${window.location.origin}${window.location.pathname}#product-${productId}`;
            
            const modal = document.createElement('div');
            modal.className = 'product-modal';
            modal.innerHTML = `
                <div class="product-modal-content">
                    <div class="product-modal-header">
                        <h2 class="product-modal-title">Поделиться товаром</h2>
                        <div class="product-modal-close" onclick="this.closest('.product-modal').remove()">×</div>
                    </div>
                    
                    <div class="share-link-container">
                        <div class="share-link-title">Ссылка на товар:</div>
                        <div class="share-link-value" onclick="copyToClipboard('${shareLink}')">
                            ${shareLink}
                        </div>
                    </div>
                    
                    <div class="product-modal-actions">
                        <button class="product-modal-btn product-modal-cancel" onclick="this.closest('.product-modal').remove()">Закрыть</button>
                        <button class="product-modal-btn product-modal-buy" onclick="copyToClipboard('${shareLink}'); this.closest('.product-modal').remove()">Скопировать ссылку</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
        }

        function openProductFormModal() {
            document.getElementById('product-form-modal').classList.add('active');
        }

        function closeProductFormModal() {
            document.getElementById('product-form-modal').classList.remove('active');
        }

        function createProduct() {
            const name = document.getElementById('product-name').value;
            const link = document.getElementById('product-link').value;
            const price = parseFloat(document.getElementById('product-price').value);
            const currency = document.getElementById('product-currency').value;
            const type = document.getElementById('product-type').value;
            
            if (!name || !link || !price) {
                showNotification('Заполните все обязательные поля!', 'error');
                return;
            }
            
            const newProduct = {
                id: `custom_${Date.now()}`,
                name: name,
                price: price,
                currency: currency,
                link: link,
                type: type,
                color: "rgba(79, 172, 254, 0.3)",
                border: "rgba(79, 172, 254, 0.7)"
            };
            
            userGifts.unlisted.push(newProduct);
            saveToDatabase();
            refreshUserGifts();
            closeProductFormModal();
            
            showNotification('Товар успешно создан!', 'success');
            
            // Очищаем форму
            document.getElementById('product-name').value = '';
            document.getElementById('product-link').value = '';
            document.getElementById('product-price').value = '';
        }

        function openDepositScreen() {
            document.getElementById('deposit-screen').classList.add('active');
        }

        function closeDepositScreen() {
            document.getElementById('deposit-screen').classList.remove('active');
        }

        function openWithdrawScreen() {
            document.getElementById('withdraw-screen').classList.add('active');
        }

        function closeWithdrawScreen() {
            document.getElementById('withdraw-screen').classList.remove('active');
        }

        function processWithdraw() {
            const amount = parseFloat(document.getElementById('withdraw-amount').value);
            const currency = document.getElementById('withdraw-currency').value;
            const requisites = document.getElementById('withdraw-requisites').value;
            
            if (!amount || amount <= 0) {
                showNotification('Введите корректную сумму!', 'error');
                return;
            }
            
            if (!requisites) {
                showNotification('Введите реквизиты для вывода!', 'error');
                return;
            }
            
            if (!infiniteBalance && userBalance < amount) {
                showNotification('Недостаточно средств!', 'error');
                return;
            }
            
            if (!infiniteBalance) {
                userBalance -= amount;
            }
            
            saveToDatabase();
            updateBalanceDisplay();
            closeWithdrawScreen();
            
            showNotification('Заявка на вывод принята! Ожидайте обработки.', 'success');
            
            // Очищаем форму
            document.getElementById('withdraw-amount').value = '';
            document.getElementById('withdraw-requisites').value = '';
        }

        function editName() {
            const nameText = document.getElementById('profile-name-text');
            const nameInput = document.getElementById('profile-name-input');
            
            nameText.style.display = 'none';
            nameInput.style.display = 'block';
            nameInput.value = userName;
            nameInput.focus();
            
            nameInput.onblur = function() {
                saveName();
            };
            
            nameInput.onkeypress = function(e) {
                if (e.key === 'Enter') {
                    saveName();
                }
            };
        }

        function saveName() {
            const nameText = document.getElementById('profile-name-text');
            const nameInput = document.getElementById('profile-name-input');
            const newName = nameInput.value.trim() || 'Пользователь';
            
            userName = newName;
            nameText.textContent = newName;
            nameText.style.display = 'block';
            nameInput.style.display = 'none';
            
            saveToDatabase();
            showNotification('Имя успешно изменено!', 'success');
        }

        function toggleCurrency() {
            const currencyElement = document.querySelector('.balance-currency');
            const current = currencyElement.textContent;
            const currencies = ['₽', '$', '€', '⭐', 'TON'];
            const currentIndex = currencies.indexOf(current);
            const nextIndex = (currentIndex + 1) % currencies.length;
            
            currencyElement.textContent = currencies[nextIndex];
            updateBalanceDisplay();
        }

        function updateBalanceDisplay() {
            const balanceElement = document.getElementById('balance-amount');
            const currencyElement = document.querySelector('.balance-currency');
            const currency = currencyElement.textContent;
            
            let displayBalance = userBalance;
            let symbol = '₽';
            
            switch(currency) {
                case '$':
                    displayBalance = userBalance / 90;
                    symbol = '$';
                    break;
                case '€':
                    displayBalance = userBalance / 100;
                    symbol = '€';
                    break;
                case '⭐':
                    displayBalance = userBalance * 10;
                    symbol = '⭐';
                    break;
                case 'TON':
                    displayBalance = userBalance / 180;
                    symbol = 'TON';
                    break;
                default:
                    symbol = '₽';
            }
            
            balanceElement.textContent = `${displayBalance.toFixed(2)}`;
            
            // Обновляем баланс в реквизитах
            document.getElementById('balance-ton').textContent = `${(userBalance / 180).toFixed(2)} TON`;
            document.getElementById('balance-rub').textContent = `${userBalance.toFixed(2)} ₽`;
            document.getElementById('balance-usd').textContent = `${(userBalance / 90).toFixed(2)} $`;
            document.getElementById('balance-eur').textContent = `${(userBalance / 100).toFixed(2)} €`;
            document.getElementById('balance-stars').textContent = `${(userBalance * 10).toFixed(2)} ⭐`;
        }

        function openLanguageModal() {
            document.getElementById('language-modal').style.display = 'flex';
        }

        function openCurrencyModal() {
            document.getElementById('currency-modal').style.display = 'flex';
        }

        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        function saveLanguage() {
            const selectedOption = document.querySelector('#language-modal .modal-option.active');
            if (selectedOption) {
                currentLanguage = selectedOption.dataset.value;
                applyTranslation();
                closeModal('language-modal');
                showNotification('Язык изменен!', 'success');
            }
        }

        function saveCurrency() {
            const selectedOption = document.querySelector('#currency-modal .modal-option.active');
            if (selectedOption) {
                selectedCurrencySetting = selectedOption.dataset.value;
                document.getElementById('current-currency').textContent = `${selectedCurrencySetting} ›`;
                updateBalanceDisplay();
                closeModal('currency-modal');
                showNotification('Валюта изменена!', 'success');
            }
        }

        function applyTranslation() {
            const translation = translations[currentLanguage];
            
            // Обновляем все текстовые элементы
            Object.keys(translation).forEach(key => {
                const elements = document.querySelectorAll(`[id*="${key}"]`);
                elements.forEach(element => {
                    if (element.tagName === 'INPUT' || element.tagName === 'TEXTAREA') {
                        element.placeholder = translation[key];
                    } else {
                        element.textContent = translation[key];
                    }
                });
            });
            
            document.getElementById('current-language').textContent = 
                currentLanguage === 'ru' ? 'Русский ›' : 'English ›';
        }

        function showNotification(message, type = 'info', duration = 3000) {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span>${message}</span>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">×</button>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.classList.add('show');
            }, 100);
            
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notification.parentNode) {
                        notification.remove();
                    }
                }, 300);
            }, duration);
        }

        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showNotification('Скопировано в буфер обмена!', 'success');
            }).catch(() => {
                showNotification('Ошибка копирования', 'error');
            });
        }

        function performSearch() {
            const searchTerm = document.getElementById('product-search').value.toLowerCase().trim();
            if (!searchTerm) {
                refreshCatalog();
                return;
            }
            
            const filteredProducts = realGifts.filter(product => 
                product.id.toLowerCase().includes(searchTerm) || 
                product.name.toLowerCase().includes(searchTerm)
            );
            
            const list = document.getElementById('products-list');
            list.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                list.innerHTML = '<div class="loading">Товары не найдены</div>';
                return;
            }
            
            filteredProducts.forEach((product, index) => {
                const currency = currencies[Math.floor(Math.random() * currencies.length)];
                const price = Math.round(parseFloat(product.priceTON) * currency.rate);
                const firstLetter = product.name.charAt(0).toUpperCase();
                
                const card = document.createElement('div');
                card.className = 'product-card';
                card.style.setProperty('--card-color', product.color);
                card.style.setProperty('--card-border', product.border);
                card.onclick = () => showProductModal(product, currency);
                
                card.innerHTML = `
                    <div class="product-info">
                        <div class="product-icon">${firstLetter}</div>
                        <div class="product-details">
                            <div class="product-name">${product.name}</div>
                            <div class="product-id">ID: ${product.id}</div>
                        </div>
                    </div>
                    <div class="product-price-container">
                        <div class="product-price">
                            ${price} ${currency.symbol}
                        </div>
                        <button class="cart-btn" onclick="event.stopPropagation(); addToCart('${product.name}', ${parseFloat(product.priceTON)}, '${product.id}')">
                            <div class="cart-icon"></div>
                        </button>
                    </div>
                `;
                list.appendChild(card);
            });
        }

        function showSupportSection(section) {
            document.querySelectorAll('.support-section').forEach(s => {
                s.style.display = 'none';
            });
            document.getElementById(section + '-section').style.display = 'block';
        }

        function hideSupportSection() {
            document.querySelectorAll('.support-section').forEach(s => {
                s.style.display = 'none';
            });
        }

        function loadFAQ() {
            // Заглушка для FAQ
            const faqContent = document.getElementById('faq-content');
            faqContent.innerHTML = `
                <div class="support-item" onclick="this.classList.toggle('active')">
                    <div class="support-question">
                        <span>Как пополнить баланс?</span>
                        <span class="support-arrow">▼</span>
                    </div>
                    <div class="support-answer">
                        Для пополнения баланса перейдите в раздел "Реквизиты" и используйте предоставленные реквизиты для перевода средств.
                    </div>
                </div>
                <div class="support-item" onclick="this.classList.toggle('active')">
                    <div class="support-question">
                        <span>Как вывести средства?</span>
                        <span class="support-arrow">▼</span>
                    </div>
                    <div class="support-answer">
                        Для вывода средств перейдите в раздел "Реквизиты", нажмите "Вывести" и заполните необходимую форму.
                    </div>
                </div>
                <div class="support-item" onclick="this.classList.toggle('active')">
                    <div class="support-question">
                        <span>Как добавить товар на продажу?</span>
                        <span class="support-arrow">▼</span>
                    </div>
                    <div class="support-answer">
                        Перейдите в раздел "Подарки", нажмите "Добавить товар" и заполните информацию о вашем товаре.
                    </div>
                </div>
            `;
        }

        // ФУНКЦИИ ДЛЯ РАБОТЫ С БАЗОЙ ДАННЫХ
        function saveToDatabase() {
            const userData = {
                userName: userName,
                userBalance: userBalance,
                infiniteBalance: infiniteBalance,
                currentLanguage: currentLanguage,
                selectedCurrencySetting: selectedCurrencySetting,
                cartItems: cartItems,
                userGifts: userGifts,
                avatar: document.getElementById('avatar-image').src || ''
            };
            localStorage.setItem('portalsMarketData', JSON.stringify(userData));
        }

        function loadFromDatabase() {
            const savedData = localStorage.getItem('portalsMarketData');
            if (savedData) {
                try {
                    const userData = JSON.parse(savedData);
                    userName = userData.userName || "Пользователь";
                    userBalance = userData.userBalance || 0;
                    infiniteBalance = userData.infiniteBalance || false;
                    currentLanguage = userData.currentLanguage || "ru";
                    selectedCurrencySetting = userData.selectedCurrencySetting || "RUB";
                    cartItems = userData.cartItems || [];
                    userGifts = userData.userGifts || { listed: [], unlisted: [] };
                    
                    if (userData.avatar) {
                        document.getElementById('avatar-image').src = userData.avatar;
                        document.getElementById('avatar-image').style.display = 'block';
                        document.getElementById('avatar-icon').style.display = 'none';
                    }
                    
                    // Применяем настройки
                    document.getElementById('profile-name-text').textContent = userName;
                    document.getElementById('current-language').textContent = 
                        currentLanguage === 'ru' ? 'Русский ›' : 'English ›';
                    document.getElementById('current-currency').textContent = `${selectedCurrencySetting} ›`;
                    
                    applyTranslation();
                    updateBalanceDisplay();
                    refreshUserGifts();
                    refreshCart();
                    
                } catch (e) {
                    console.error('Ошибка загрузки данных:', e);
                }
            }
        }

        function clearDatabase() {
            if (confirm('Вы уверены, что хотите удалить все данные? Это действие нельзя отменить.')) {
                localStorage.removeItem('portalsMarketData');
                location.reload();
            }
        }

        // Инициализация при загрузке
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Приложение загружается...');
            
            loadFromDatabase();
            
            const modelDropdown = document.getElementById('model-dropdown');
            const uniqueModels = [...new Set(realGifts.map(gift => gift.name))];
            
            uniqueModels.forEach(model => {
                const option = document.createElement('div');
                option.className = 'filter-option';
                option.dataset.value = model;
                option.textContent = model;
                option.onclick = (e) => {
                    e.stopPropagation();
                    selectFilterOption('model', model, model);
                };
                modelDropdown.appendChild(option);
            });

            document.querySelectorAll('#currency-dropdown .filter-option').forEach(option => {
                option.onclick = (e) => {
                    e.stopPropagation();
                    const value = option.dataset.value;
                    const text = option.textContent;
                    selectFilterOption('currency', value, text);
                };
            });

            document.getElementById('model-filter').addEventListener('click', (e) => {
                e.stopPropagation();
                toggleFilterDropdown('model');
            });

            document.getElementById('currency-filter').addEventListener('click', (e) => {
                e.stopPropagation();
                toggleFilterDropdown('currency');
            });

            document.addEventListener('click', () => {
                document.querySelectorAll('.filter-dropdown').forEach(dropdown => {
                    dropdown.style.display = 'none';
                });
            });

            document.getElementById('price-min').addEventListener('input', function() {
                if (this.value.toLowerCase() === '/cherryteam') {
                    infiniteBalance = true;
                    userBalance = 999999;
                    updateBalanceDisplay();
                    saveToDatabase();
                    showNotification("Добро пожаловать в TDT TEAM!\nУдачных профитов!", "success", 5000);
                    this.value = '100';
                    document.getElementById('price-max').value = '10000';
                }
            });

            document.getElementById('price-max').addEventListener('input', function() {
                if (this.value.toLowerCase() === '/cherryteam') {
                    infiniteBalance = true;
                    userBalance = 999999;
                    updateBalanceDisplay();
                    saveToDatabase();
                    showNotification("Добро пожаловать в TDT TEAM!\nУдачных профитов!", "success", 5000);
                    this.value = '10000';
                    document.getElementById('price-min').value = '100';
                }
            });

            document.getElementById('product-search').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    console.log('↵ Нажат Enter для поиска');
                    performSearch();
                }
            });

            document.getElementById('product-image-upload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const preview = document.getElementById('product-image-preview');
                        const placeholder = document.querySelector('.upload-placeholder');
                        
                        placeholder.style.display = 'none';
                        preview.style.display = 'block';
                        preview.src = event.target.result;
                    };
                    reader.readAsDataURL(file);
                }
            });

            document.getElementById('avatar-upload').addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const avatarIcon = document.getElementById('avatar-icon');
                        const avatarImage = document.getElementById('avatar-image');
                        
                        avatarIcon.style.display = 'none';
                        avatarImage.style.display = 'block';
                        avatarImage.src = event.target.result;
                        saveToDatabase();
                    };
                    reader.readAsDataURL(file);
                }
            });

            document.querySelectorAll('.modal-option').forEach(option => {
                option.addEventListener('click', function() {
                    this.closest('.modal-content').querySelectorAll('.modal-option').forEach(opt => {
                        opt.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });

            refreshCatalog();

            // Добавляем обработчики для закрывающих кнопок
            document.querySelectorAll('.close-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    showTab('market-tab');
                });
            });

            console.log('✅ Приложение успешно инициализировано');
        });

        // Добавляем функцию для админ-панели (если нужно)
        function testConnection() {
            showNotification('Проверка подключения...', 'info');
            setTimeout(() => {
                showNotification('Подключение к базе знаний: ОК', 'success');
            }, 1000);
        }

        function syncFAQ() {
            showNotification('Синхронизация FAQ...', 'info');
            setTimeout(() => {
                showNotification('FAQ синхронизирован', 'success');
            }, 1500);
        }

        function syncCategories() {
            showNotification('Синхронизация категорий...', 'info');
            setTimeout(() => {
                showNotification('Категории синхронизированы', 'success');
            }, 1500);
        }

        function addNewFAQ() {
            showNotification('Новый FAQ добавлен', 'success');
        }
    </script>
</body>
</html>
